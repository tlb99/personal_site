<div class="container page">
  <div class="editor-header">
    <div>
      <h1>{{ isEdit ? 'Edit Post' : 'New Post' }}</h1>
    </div>
    <a routerLink="/blog" class="btn btn-secondary">← Back</a>
  </div>

  <div *ngIf="successMsg" class="alert alert-success">{{ successMsg }}</div>
  <div *ngIf="errorMsg" class="alert alert-error">{{ errorMsg }}</div>

  <!-- Meta fields -->
  <div class="meta-row">
    <div class="form-group">
      <label for="title">Title</label>
      <input
        id="title"
        type="text"
        [(ngModel)]="title"
        (input)="autoSlug()"
        placeholder="Post title…"
      />
    </div>
    <div class="form-group">
      <label for="slug">Slug</label>
      <input
        id="slug"
        type="text"
        [(ngModel)]="slug"
        placeholder="post-url-slug"
      />
    </div>
  </div>

  <div class="form-group">
    <label for="summary">Summary</label>
    <input
      id="summary"
      type="text"
      [(ngModel)]="summary"
      placeholder="A short description shown in listings…"
    />
  </div>

  <!-- Publish toggle -->
  <label class="publish-toggle">
    <input type="checkbox" [(ngModel)]="published" />
    <div>
      <span>{{ published ? 'Published' : 'Draft' }}</span>
      <small>{{ published ? 'Visible to everyone' : 'Only visible in admin view' }}</small>
    </div>
  </label>

  <!-- Editor / Preview split -->
  <div class="editor-layout">
    <div class="editor-pane">
      <h3>Markdown</h3>
      <div class="form-group" style="margin-bottom:0">
        <textarea
          class="content-area"
          [(ngModel)]="content"
          (input)="updatePreview()"
          placeholder="Write your post in Markdown…"
        ></textarea>
      </div>
    </div>
    <div class="editor-pane">
      <h3>Preview</h3>
      <div class="preview-pane prose" [innerHTML]="preview">
        <span *ngIf="!content" style="color:var(--text-muted); font-size:0.9rem">Preview will appear here…</span>
      </div>
    </div>
  </div>

  <div class="form-actions" style="margin-top:1.5rem">
    <button class="btn btn-primary" (click)="save()" [disabled]="saving">
      {{ saving ? 'Saving…' : (isEdit ? 'Save Changes' : 'Publish Post') }}
    </button>
    <a routerLink="/blog" class="btn btn-secondary">Cancel</a>
  </div>
</div>
